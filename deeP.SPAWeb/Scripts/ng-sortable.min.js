(function(){"use strict";angular.module("as.sortable",[]).constant("sortableConfig",{itemClass:"as-sortable-item",handleClass:"as-sortable-item-handle",placeHolderClass:"as-sortable-placeholder",dragClass:"as-sortable-drag",hiddenClass:"as-sortable-hidden",dragging:"as-sortable-dragging"})})(),function(){"use strict";var n=angular.module("as.sortable");n.factory("$helper",["$document","$window",function(n,t){return{height:function(n){return n[0].getBoundingClientRect().height},width:function(n){return n[0].getBoundingClientRect().width},offset:function(i,r){var u=i[0].getBoundingClientRect();return r||(r=n[0].documentElement),{width:u.width||i.prop("offsetWidth"),height:u.height||i.prop("offsetHeight"),top:u.top+(t.pageYOffset||r.scrollTop-r.offsetTop),left:u.left+(t.pageXOffset||r.scrollLeft-r.offsetLeft)}},eventObj:function(n){var t=n;return n.targetTouches!==undefined?t=n.targetTouches.item(0):n.originalEvent!==undefined&&n.originalEvent.targetTouches!==undefined&&(t=n.originalEvent.targetTouches.item(0)),t},isTouchInvalid:function(n){var t=!1;return n.touches!==undefined&&n.touches.length>1?t=!0:n.originalEvent!==undefined&&n.originalEvent.touches!==undefined&&n.originalEvent.touches.length>1&&(t=!0),t},positionStarted:function(n,t,i){var r={};return r.offsetX=n.pageX-this.offset(t,i).left,r.offsetY=n.pageY-this.offset(t,i).top,r.startX=r.lastX=n.pageX,r.startY=r.lastY=n.pageY,r.nowX=r.nowY=r.distX=r.distY=r.dirAx=0,r.dirX=r.dirY=r.lastDirX=r.lastDirY=r.distAxX=r.distAxY=0,r},calculatePosition:function(n,t){n.lastX=n.nowX;n.lastY=n.nowY;n.nowX=t.pageX;n.nowY=t.pageY;n.distX=n.nowX-n.lastX;n.distY=n.nowY-n.lastY;n.lastDirX=n.dirX;n.lastDirY=n.dirY;n.dirX=n.distX===0?0:n.distX>0?1:-1;n.dirY=n.distY===0?0:n.distY>0?1:-1;var i=Math.abs(n.distX)>Math.abs(n.distY)?1:0;n.dirAx!==i?(n.distAxX=0,n.distAxY=0):(n.distAxX+=Math.abs(n.distX),n.dirX!==0&&n.dirX!==n.lastDirX&&(n.distAxX=0),n.distAxY+=Math.abs(n.distY),n.dirY!==0&&n.dirY!==n.lastDirY&&(n.distAxY=0));n.dirAx=i},movePosition:function(n,t,i,r,u,f){var e,o=u==="relative";t.x=n.pageX-i.offsetX;t.y=n.pageY-i.offsetY;r&&(e=this.offset(r,f),o&&(t.x-=e.left,t.y-=e.top,e.left=0,e.top=0),t.x<e.left?t.x=e.left:t.x>=e.width+e.left-this.offset(t).width&&(t.x=e.width+e.left-this.offset(t).width),t.y<e.top?t.y=e.top:t.y>=e.height+e.top-this.offset(t).height&&(t.y=e.height+e.top-this.offset(t).height));t.css({left:t.x+"px",top:t.y+"px"});this.calculatePosition(i,n)},dragItem:function(n){return{index:n.index(),parent:n.sortableScope,source:n,sourceInfo:{index:n.index(),itemScope:n.itemScope,sortableScope:n.sortableScope},moveTo:function(n,t){this.parent=n;this.isSameParent()&&this.source.index()<t&&(t=t-1);this.index=t},isSameParent:function(){return this.parent.element===this.sourceInfo.sortableScope.element},isOrderChanged:function(){return this.index!==this.sourceInfo.index},eventArgs:function(){return{source:this.sourceInfo,dest:{index:this.index,sortableScope:this.parent}}},apply:function(){this.sourceInfo.sortableScope.options.clone||this.sourceInfo.sortableScope.removeItem(this.sourceInfo.index);(this.parent.options.allowDuplicates||this.parent.modelValue.indexOf(this.source.modelValue)<0)&&this.parent.insertItem(this.index,this.source.modelValue)}}},noDrag:function(n){return n.attr("no-drag")!==undefined||n.attr("data-no-drag")!==undefined},findAncestor:function(n,t){n=n[0];for(var i=Element.matches||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector;(n=n.parentElement)&&!i.call(n,t););return n?angular.element(n):angular.element(document.body)}}}])}(),function(){"use strict";var n=angular.module("as.sortable");n.controller("as.sortable.sortableController",["$scope",function(n){this.scope=n;n.modelValue=null;n.callbacks=null;n.type="sortable";n.options={};n.isDisabled=!1;n.insertItem=function(t,i){n.options.allowDuplicates?n.modelValue.splice(t,0,angular.copy(i)):n.modelValue.splice(t,0,i)};n.removeItem=function(t){var i=null;return t>-1&&(i=n.modelValue.splice(t,1)[0]),i};n.isEmpty=function(){return n.modelValue&&n.modelValue.length===0};n.accept=function(t,i,r){return n.callbacks.accept(t,i,r)}}]);n.directive("asSortable",function(){return{require:"ngModel",restrict:"A",scope:!0,controller:"as.sortable.sortableController",link:function(n,t,i,r){var f,u;(f=r,f)&&(f.$render=function(){n.modelValue=f.$modelValue},n.element=t,t.data("_scope",n),u={accept:null,orderChanged:null,itemMoved:null,dragStart:null,dragMove:null,dragCancel:null,dragEnd:null},u.accept=function(){return!0},u.orderChanged=function(){},u.itemMoved=function(){},u.dragStart=function(){},u.dragMove=angular.noop,u.dragCancel=function(){},u.dragEnd=function(){},n.$watch(i.asSortable,function(t){angular.forEach(t,function(t,i){u[i]?typeof t=="function"&&(u[i]=t):n.options[i]=t});n.callbacks=u},!0),angular.isDefined(i.isDisabled)&&n.$watch(i.isDisabled,function(t){angular.isUndefined(t)||(n.isDisabled=t)},!0))}}})}(),function(){"use strict";function t(n,i){return!i||i.nodeName==="HTML"?!1:i.parentNode===n?!0:t(n,i.parentNode)}var n=angular.module("as.sortable");n.controller("as.sortable.sortableItemHandleController",["$scope",function(n){this.scope=n;n.itemScope=null;n.type="handle"}]);n.directive("asSortableItemHandle",["sortableConfig","$helper","$window","$document",function(n,i,r,u){return{require:"^asSortableItem",scope:!0,restrict:"A",controller:"as.sortable.sortableItemHandleController",link:function(f,e,o,s){function vt(n,t){l.css("display")!=="table-row"&&l.css("display","block");t.sortableScope.options.clone||(n[0].parentNode.insertBefore(l[0],n[0]),c.moveTo(t.sortableScope,t.index()))}function wt(n,t){l.css("display")!=="table-row"&&l.css("display","block");t.sortableScope.options.clone||(n.after(l),c.moveTo(t.sortableScope,t.index()+1))}function yt(n){for(var t;!t&&n.length;)t=n.data("_scope"),t||(n=n.parent());return t}function pt(){b.replaceWith(f.itemScope.element);l.remove();h.remove();h=null;v=!1;a.css("cursor","");a.removeClass("as-sortable-un-selectable")}var h,l,b,k,c,a,tt,y,d,ot,p,w,g,st,it,rt,ht,ct,ut,nt,v,lt,at,ft=!1,et;nt=r.hasOwnProperty("ontouchstart");n.handleClass&&e.addClass(n.handleClass);f.itemScope=s.scope;e.data("_scope",f);f.$watch("sortableScope.isDisabled",function(n){ft!==n&&(ft=n,ft?ht():rt())});f.$on("$destroy",function(){angular.element(u[0].body).unbind("keydown",et)});lt=function(n){return typeof f.sortableScope.options.placeholder=="function"?angular.element(f.sortableScope.options.placeholder(n)):typeof f.sortableScope.options.placeholder=="string"?angular.element(f.sortableScope.options.placeholder):angular.element(u[0].createElement(n.element.prop("tagName")))};y=function(n){var t=function(){angular.element(u).unbind("mousemove",f);angular.element(u).unbind("touchmove",f);e.unbind("mouseup",t);e.unbind("touchend",t);e.unbind("touchcancel",t)},r,f=function(u){u.preventDefault();var f=i.eventObj(u);r||(r={clientX:f.clientX,clientY:f.clientY});Math.abs(f.clientX-r.clientX)+Math.abs(f.clientY-r.clientY)>10&&(t(),ot(n))};angular.element(u).bind("mousemove",f);angular.element(u).bind("touchmove",f);e.bind("mouseup",t);e.bind("touchend",t);e.bind("touchcancel",t);n.stopPropagation()};ot=function(t){var r,o;(nt||t.button!==2&&t.which!==3)&&(nt&&i.isTouchInvalid(t)||!v&&st(t)&&(v=!0,t.preventDefault(),r=i.eventObj(t),f.sortableScope=f.sortableScope||f.itemScope.sortableScope,f.callbacks=f.callbacks||f.itemScope.callbacks,d=angular.element(u[0].querySelector(f.sortableScope.options.scrollableContainer)).length>0?u[0].querySelector(f.sortableScope.options.scrollableContainer):u[0].documentElement,a=f.sortableScope.options.containment?i.findAncestor(e,f.sortableScope.options.containment):angular.element(u[0].body),a.css("cursor","move"),a.css("cursor","-webkit-grabbing"),a.css("cursor","-moz-grabbing"),a.addClass("as-sortable-un-selectable"),tt=f.sortableScope.options.containerPositioning||"absolute",c=i.dragItem(f),o=f.itemScope.element.prop("tagName"),h=angular.element(u[0].createElement(f.sortableScope.element.prop("tagName"))).addClass(f.sortableScope.element.attr("class")).addClass(n.dragClass),h.css("width",i.width(f.itemScope.element)+"px"),h.css("height",i.height(f.itemScope.element)+"px"),l=lt(f.itemScope).addClass(n.placeHolderClass).addClass(f.sortableScope.options.additionalPlaceholderClass),l.css("width",i.width(f.itemScope.element)+"px"),l.css("height",i.height(f.itemScope.element)+"px"),b=angular.element(u[0].createElement(o)),n.hiddenClass&&b.addClass(n.hiddenClass),k=i.positionStarted(r,f.itemScope.element,d),f.itemScope.sortableScope.options.clone||f.itemScope.element.after(l),f.itemScope.element.after(b),f.itemScope.sortableScope.options.clone?h.append(f.itemScope.element.clone()):h.append(f.itemScope.element),a.append(h),i.movePosition(r,h,k,a,tt,d),f.sortableScope.$apply(function(){f.callbacks.dragStart(c.eventArgs())}),ct()))};st=function(n){var t,u,r;for(t=angular.element(n.target),u=yt(t),r=u&&u.type==="handle";r&&t[0]!==e[0];)i.noDrag(t)&&(r=!1),t=t.parent();return r};p=function(e){var y,p,w,o,s,b;if((!nt||!i.isTouchInvalid(e))&&v&&h){if(e.preventDefault(),y=i.eventObj(e),f.callbacks.dragMove!==angular.noop&&f.sortableScope.$apply(function(){f.callbacks.dragMove(k,a,y)}),i.movePosition(y,h,k,a,tt,d),p=y.pageX-u[0].documentElement.scrollLeft,w=y.pageY-(r.pageYOffset||u[0].documentElement.scrollTop),h.addClass(n.hiddenClass),u[0].elementFromPoint(p,w),s=angular.element(u[0].elementFromPoint(p,w)),h.removeClass(n.hiddenClass),h.addClass(n.dragging),o=yt(s),!o||!o.type)return;if(o.type==="handle"&&(o=o.itemScope),o.type!=="item"&&o.type!=="sortable")return;o.type==="item"&&o.accept(f,o.sortableScope,o)&&(s=o.element,b=it(o.sortableScope.element),b<0?vt(s,o):b<=o.index()?wt(s,o):vt(s,o));o.type==="sortable"&&o.accept(f,o)&&!t(o.element[0],s[0])&&(at(s)||o.options.clone||(s[0].appendChild(l[0]),c.moveTo(o,o.modelValue.length)))}};it=function(t){var r,i;if(t.hasClass(n.placeHolderClass))return 0;for(r=t.children(),i=0;i<r.length;i+=1)if(angular.element(r[i]).hasClass(n.placeHolderClass))return i;return-1};at=function(n){return it(n)>=0};w=function(n){v&&(n.preventDefault(),h&&(pt(),c.apply(),f.sortableScope.$apply(function(){c.isSameParent()?c.isOrderChanged()&&f.callbacks.orderChanged(c.eventArgs()):f.callbacks.itemMoved(c.eventArgs())}),f.sortableScope.$apply(function(){f.callbacks.dragEnd(c.eventArgs())}),c=null),ut())};g=function(n){v&&(n.preventDefault(),h&&(pt(),f.sortableScope.$apply(function(){f.callbacks.dragCancel(c.eventArgs())}),c=null),ut())};rt=function(){e.bind("touchstart",y);e.bind("mousedown",y)};ht=function(){e.unbind("touchstart",y);e.unbind("mousedown",y)};rt();et=function(n){n.keyCode===27&&g(n)};angular.element(u[0].body).bind("keydown",et);ct=function(){angular.element(u).bind("touchmove",p);angular.element(u).bind("touchend",w);angular.element(u).bind("touchcancel",g);angular.element(u).bind("mousemove",p);angular.element(u).bind("mouseup",w)};ut=function(){angular.element(u).unbind("touchend",w);angular.element(u).unbind("touchcancel",g);angular.element(u).unbind("touchmove",p);angular.element(u).unbind("mouseup",w);angular.element(u).unbind("mousemove",p)}}}}])}(),function(){"use strict";var n=angular.module("as.sortable");n.controller("as.sortable.sortableItemController",["$scope",function(n){this.scope=n;n.sortableScope=null;n.modelValue=null;n.type="item";n.index=function(){return n.$index};n.itemData=function(){return n.sortableScope.modelValue[n.$index]}}]);n.directive("asSortableItem",["sortableConfig",function(n){return{require:["^asSortable","?ngModel"],restrict:"A",controller:"as.sortable.sortableItemController",link:function(t,i,r,u){var e=u[0],f=u[1];n.itemClass&&i.addClass(n.itemClass);t.sortableScope=e.scope;f?f.$render=function(){t.modelValue=f.$modelValue}:t.modelValue=e.scope.modelValue[t.$index];t.element=i;i.data("_scope",t)}}}])}();
//# sourceMappingURL=ng-sortable.min.js.map
